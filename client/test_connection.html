<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>WebSocket Test</title>
</head>
<body>
  <h1>WebSocket Test Page</h1>
  <p id="status">Connecting...</p>
  <script>
    const status = document.getElementById("status");

    const socket = new WebSocket("ws://localhost:8081");

    socket.onopen = function() {
      status.textContent = "Connected to WebSocket server!";

      // Create a JSON object to send
      const payload = {
        type: "text",
        data: ""
      };

	  payload.data = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus porta dignissim dui et pretium. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Phasellus ac augue in ipsum venenatis bibendum at sed eros. Phasellus eu mi in libero porta feugiat vel eu quam. Praesent fermentum ante dui, ac congue sapien rutrum nec. Donec nec sollicitudin quam, ac vehicula quam. Etiam fringilla tortor sed est consequat dictum. In egestas augue nec metus venenatis, non posuere dui scelerisque. Curabitur nec laoreet tellus, in sollicitudin nisi.";

	  /*
	  for (i=0;i<70000;i++) {
		payload.data += 'A';
	  } 
	  */

	  const payload_json = JSON.stringify(payload);
	  console.log(payload_json);
	  console.log(payload_json.length);
      // Send as JSON string
      socket.send(payload_json);
    };

    socket.onmessage = function(event) {
      console.log("Message from server:", event.data);
    };

    socket.onerror = function(error) {
      status.textContent = "WebSocket error!";
      console.error("WebSocket error:", error);
    };

    socket.onclose = function() {
      status.textContent = "Connection closed.";
    };
  </script>
</body>
</html>